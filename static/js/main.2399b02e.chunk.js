(this["webpackJsonpinteractive-book-editor"]=this["webpackJsonpinteractive-book-editor"]||[]).push([[0],{100:function(e,t,a){e.exports=a(226)},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},113:function(e,t,a){},174:function(e,t){},176:function(e,t){},221:function(e,t,a){},222:function(e,t,a){},223:function(e,t,a){},224:function(e,t,a){},225:function(e,t,a){},226:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(95),r=a.n(c),i=(a(105),a(2)),o=(a(106),a(21),a(25)),s=a(17),m=(a(107),l.a.memo((function(e){var t=Object(n.useState)(null),a=Object(i.a)(t,2),c=a[0],r=a[1];Object(n.useEffect)((function(){var t=e.pathName;r(t)}),[e.pathName]);var s=function(e,t){return l.a.createElement(o.b,{to:t},l.a.createElement("div",{className:"link"},e))};return l.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-dark bg-dark"},l.a.createElement("div",{className:"container-fluid"},l.a.createElement("div",{className:"navbar-header"},l.a.createElement("a",{className:"navbar-brand",href:"#"},l.a.createElement("img",{src:"".concat("/interactive-book-editor","/images/temp_logo.png"),className:"logo-img"}))),[{text:"About",to:"/about"},{text:"Upload a New Book File",to:"/upload"},{text:"Edit Book Triggers",to:"/edit"},{text:"Preview Read Book",to:"/preview"},{text:"Contact Us",to:"/contact"}].map((function(e,t){var a=e.text,n=e.to;return l.a.createElement("li",{key:t},n===c?function(e){return l.a.createElement("div",{className:"link-active"},e)}(a):s(a,n))})),l.a.createElement("ul",{className:"nav navbar-nav"}),l.a.createElement("ul",{className:"nav navbar-nav navbar-right"},l.a.createElement("li",null,s("Login","/login")))))}))),u=a(60),d=a.n(u),b=a(98),E=(a(113),a(99)),f=a.n(E),v=l.a.memo((function(e){var t=Object(n.useState)(""),a=Object(i.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(!1),m=Object(i.a)(o,2),u=m[0],E=m[1],v=Object(n.useState)(null),p=Object(i.a)(v,2),g=p[0],h=p[1],N=Object(n.useState)(""),k=Object(i.a)(N,2),j=k[0],O=k[1],x=Object(n.useState)(!1),w=Object(i.a)(x,2),y=w[0],C=w[1],S=function(){var t=Object(b.a)(d.a.mark((function t(){var a,n,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(!0),console.debug("not implemented addNewUserBook service"),t.next=4,g.arrayBuffer();case 4:return a=t.sent,t.next=7,f.a.convertToHtml({arrayBuffer:a});case 7:n=t.sent,l=n.value,C(!0),e.setBookContent(l);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return y?l.a.createElement(s.a,{from:"/upload",to:"edit"}):l.a.createElement(n.Fragment,null,l.a.createElement("div",{className:"menu-bg"},l.a.createElement("div",{className:"menu-window"},l.a.createElement("div",{className:"menu"},l.a.createElement("h4",{className:"menu-header"},"Welcome to Interactive Book Editor!"),l.a.createElement("input",{className:"col form-control mt-4 mb-3",type:"text",placeholder:"New Book Name",value:j,onChange:function(e){return O(e.target.value)}}),l.a.createElement("div",{className:"custom-file mb-2"},l.a.createElement("input",{type:"file",className:"custom-file-input",id:"inputGroupFile01",onChange:function(e){var t=e.target.files[0].name;/.*.docx/.test(t)?(h(e.target.files[0]),r("")):(h(null),r("Please only select a file ending with .docx"))}}),l.a.createElement("label",{className:"custom-file-label"},g?g.name:"Choose a docx file"),l.a.createElement("li",null,l.a.createElement("h6",null,l.a.createElement("span",{className:"badge badge-danger mt-2",hidden:!c},c)))),l.a.createElement("button",{onClick:S,className:"btn btn-success form-control mt-3",disabled:u||!g||!j},u?"Please wait...":"Load Book")))))})),p=(a(221),l.a.memo((function(e){var t="line line-text ".concat(e.line.header?"header":""),a="line add-img ".concat(e.line.header?"header":"");return l.a.createElement("div",{className:"row"},l.a.createElement("img",{className:a,src:"".concat("/interactive-book-editor","/images/add.png"),alt:"Add Trigger"}),l.a.createElement("div",{className:t,onClick:function(){return e.onLineClick(e.line.lineId,e.line.sentenceId)}},l.a.createElement("label",{dangerouslySetInnerHTML:{__html:e.line.html}})))}))),g=(a(222),0),h=1,N=0,k=1,j=2,O=0,x=1,w=["strong","em","i","b"],y=l.a.memo((function(e){return l.a.createElement("div",{className:"wrapper side-bar p-0 pt-4 m-0"},l.a.createElement("nav",{id:"sidebar",className:"fixed-pos row p-0 m-0"},l.a.createElement("ul",{className:"list-unstyled col"},l.a.createElement("div",null,l.a.createElement("h3",null,l.a.createElement("b",null,"Edit Book"))),l.a.createElement("li",null,l.a.createElement("div",{className:"side-bar-item col"},l.a.createElement("label",{className:"side-bar-item-text"},"Mark Chapter Headers"))),l.a.createElement("li",null,l.a.createElement("div",{className:"side-bar-item col"},l.a.createElement("label",{className:"dropdown-toggle side-bar-item-text"},"Display")),l.a.createElement("ul",{className:"list-unstyled",id:"homeSubmenu"},l.a.createElement("li",null,l.a.createElement("div",{onClick:function(){return e.setDisplay(g)},className:"side-bar-item-sub col".concat(e.display===g?" selected":"")},l.a.createElement("label",{className:"side-bar-item-sub-text"},"Whole Book"))),l.a.createElement("li",null,l.a.createElement("div",{onClick:function(){return e.setDisplay(h)},className:"side-bar-item-sub col".concat(e.display===h?" selected":"")},l.a.createElement("label",{className:"side-bar-item-sub-text"},"Current Chapter"))))),l.a.createElement("li",null,l.a.createElement("div",{className:"side-bar-item col"},l.a.createElement("label",{className:"dropdown-toggle side-bar-item-text"},"Split by")),l.a.createElement("ul",{className:"list-unstyled",id:"homeSubmenu"},l.a.createElement("li",null,l.a.createElement("div",{onClick:function(){return e.setSplitPattern(O)},className:"side-bar-item-sub col".concat(e.splitPattern===O?" selected":"")},l.a.createElement("label",{className:"side-bar-item-sub-text"},"Sentences"))),l.a.createElement("li",null,l.a.createElement("div",{onClick:function(){return e.setSplitPattern(x)},className:"side-bar-item-sub col".concat(e.splitPattern===x?" selected":"")},l.a.createElement("label",{className:"side-bar-item-sub-text"},"Lines"))))),l.a.createElement("li",null,l.a.createElement("div",{className:"side-bar-item col"},l.a.createElement("label",{className:"dropdown-toggle side-bar-item-text"},"Filter")),l.a.createElement("ul",{className:"list-unstyled"},l.a.createElement("li",null,l.a.createElement("div",{onClick:function(){return e.setFilter(N)},className:"side-bar-item-sub col".concat(e.filter===N?" selected":"")},l.a.createElement("label",{className:"side-bar-item-sub-text"},"None"))),l.a.createElement("li",null,l.a.createElement("div",{onClick:function(){return e.setFilter(k)},className:"side-bar-item-sub col".concat(e.filter===k?" selected":"")},l.a.createElement("label",{className:"side-bar-item-sub-text"},"View Headers"))),l.a.createElement("li",null,l.a.createElement("div",{onClick:function(){return e.setFilter(j)},className:"side-bar-item-sub col".concat(e.filter===j?" selected":"")},l.a.createElement("label",{className:"side-bar-item-sub-text"},"View Trigger Lines"))))),l.a.createElement("li",null,l.a.createElement("div",{className:"side-bar-item col"},l.a.createElement("label",{className:"side-bar-item-text"},"Save Checkpoint"))),l.a.createElement("li",null,l.a.createElement("div",{className:"side-bar-item col"},l.a.createElement("label",{className:"side-bar-item-text"},"Choose Another Book"))),l.a.createElement("li",null,l.a.createElement("div",{className:"side-bar-item last col"},l.a.createElement("label",{className:"side-bar-item-text"},"Publish / Update"))))))})),C=(a(223),a(224),l.a.memo((function(e){return l.a.createElement("div",{className:"triggers-popup"},l.a.createElement("div",{className:"menu flex-column"},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:'"'+e.html+'"'}}),l.a.createElement("div",{className:"menu-header mb-3 mt-4"},"Assigned Triggers:"),e.triggers.length>0?l.a.createElement("div",{className:"row mb-4"},e.triggers.map((function(e,t){return l.a.createElement("div",{key:t},l.a.createElement("div",{className:"col-sm-3"},e.name+":"),l.a.createElement("div",{className:"col-sm-3"},e.type+":"),l.a.createElement("div",{className:"col-sm-3"},e.valueName+":"),l.a.createElement("div",{className:"col-sm-3"},l.a.createElement("button",{className:"btn btn-danger"},"Remove This Trigger")))}))):l.a.createElement("div",{className:"row mb-4"},l.a.createElement("div",{className:"col ml-3"},"There are currently no assigned triggers.")),l.a.createElement("div",{className:"row"},l.a.createElement("button",{onClick:e.closePopUp,className:"btn btn-light col-4 offset-4"},"Close"))))}))),S=l.a.memo((function(e){var t=e.bookContent,a=Object(n.useState)(null),c=Object(i.a)(a,2),r=c[0],o=c[1],s=Object(n.useState)(g),m=Object(i.a)(s,2),u=m[0],d=m[1],b=Object(n.useState)(N),E=Object(i.a)(b,2),f=E[0],v=E[1],h=Object(n.useState)(O),k=Object(i.a)(h,2),j=k[0],S=k[1],B=Object(n.useState)(!!t),I=Object(i.a)(B,2),P=I[0],D=I[1],F=Object(n.useState)(null),T=Object(i.a)(F,2),L=(T[0],T[1]),_=Object(n.useState)(null),H=Object(i.a)(_,2),U=(H[0],H[1]),M=Object(n.useState)(null),A=Object(i.a)(M,2),R=A[0],W=A[1],J=Object(n.useState)(!1),V=Object(i.a)(J,2),G=V[0],$=V[1],q=Object(n.useState)([]),z=Object(i.a)(q,2),K=z[0],Q=z[1],X=function(e){if(!e[0])return!1;var t=e[0].text;return/chapter/i.test(t)||/episode/i.test(t)},Y=function(){var e="<(".concat(w.map((function(e){return"|(".concat(e,")")})),")>").split(",").join("").replace("|","");return new RegExp(e)},Z=function(e){for(var t=[],a=[],n=0;n<e.length;n++){for(var l=e[n].split(/<\/?/).join("%%<"),c=(l=l.split(">").join(">%%")).split("%%"),r=[],i=0;i<c.length;i++){var o=c[i].match(Y());if(o){if(o[1]){var s=o[1],m=t.indexOf(s);m>-1?t.splice(m,1):t.push(s)}}else""!==c[i]&&r.push({text:c[i],tags:[].concat(t)})}a[n]={parts:[].concat(r),header:X(r),sentenceId:n,triggers:[]}}return a};Object(n.useEffect)((function(){t&&(D(!0),function(){var a=t.split("</p><p>"),n=(a=a.map((function(e){return e.split(". ").join(".<p>").split(/<\/?p>/).filter((function(e){return""!==e}))}))).map((function(e,t){return{content:Z(e),lineId:t}}));o(n),e.setBookData(n)}(),D(!1))}),[t]);var ee=function(e,t){L(e),U(t),W(function(e,t){var a=r[e];if(null!=t){var n=a.content[t];return ae(n)}return le(a)}(e,t)),Q(function(e,t){var a=r[e];if(null!=t)return a.content[t].triggers;for(var n=[],l=0;l<a.content.length;l++)n=n.concat(a.content[l].triggers);return n}(e,t)),$(!0)},te=function(e,t){return l.a.createElement(p,{line:e,key:t,onLineClick:ee})},ae=function(e){var t="";return e.parts.forEach((function(e){e.tags.forEach((function(e){t+="<".concat(e,">")})),t+=e.text+" ",e.tags.slice(0).reverse().forEach((function(e){t+="</".concat(e,">")}))})),t},ne=function(){return r.map((function(e,t){return l.a.createElement("div",{key:e.lineId,className:"line-wrapper"},e.content.map((function(t){var a=ae(t);return te({html:a,header:t.header,lineId:e.lineId,sentenceId:t.sentenceId},t.sentenceId)})))}))},le=function(e){var t="";return e.content.forEach((function(e){e.parts.forEach((function(e){e.tags.forEach((function(e){t+="<".concat(e,">")})),t+=e.text+" ",e.tags.slice(0).reverse().forEach((function(e){t+="</".concat(e,">")}))}))})),t},ce=function(){return r.map((function(e){var t=le(e);return te({html:t,header:e.content[0].header,lineId:e.lineId,sentenceId:null},e.lineId)}))};return l.a.createElement(n.Fragment,null,l.a.createElement("div",{className:"container-fluid"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"side-bar-bg floating-col"},l.a.createElement(y,{display:u,filter:f,setDisplay:d,setFilter:v,splitPattern:j,setSplitPattern:S})),l.a.createElement("div",{className:"side-bar-mock-filler floating-col"}),l.a.createElement("div",{className:"main-edit-area floating-col"},r?j===O?ne():j===x?ce():l.a.createElement("div",null,'The "split by" value is not supported for this type of book file. Please change it to either lines or sentences.'):P?l.a.createElement("div",null,"Loading book content..."):l.a.createElement("div",null,"No book content to edit. Please use the upload page to upload a book file."),G?l.a.createElement(C,{html:R,triggers:K,closePopUp:function(){return $(!1)}}):null))))})),B=(a(225),l.a.memo((function(e){return l.a.createElement("div",{className:"container-fluid",style:{backgroundColor:"white"}},e.bookData?e.bookData.map((function(e,t){return l.a.createElement("p",{key:t},e.content.map((function(e,t){var a="";e.parts.forEach((function(e){e.tags.forEach((function(e){a+="<".concat(e,">")})),a+=e.text+" ",e.tags.slice(0).reverse().forEach((function(e){a+="</".concat(e,">")}))}));var n=(e.header?"header":"line")+"-read mr-1";return l.a.createElement("label",{dangerouslySetInnerHTML:{__html:a},key:t,className:n})})))})):null)}))),I=l.a.memo((function(e){var t=Object(s.f)(),a=e.setPathName,c=e.setBookContent,r=e.bookContent,i=e.bookData,o=e.setBookData;return Object(n.useEffect)((function(){a(t.pathname)}),[t,a]),l.a.createElement(n.Fragment,null,l.a.createElement(s.b,{exact:!0,path:"/edit"},l.a.createElement(S,{bookContent:r,setBookData:o})),l.a.createElement(s.b,{exact:!0,path:"/upload"},l.a.createElement(v,{setBookContent:c})),l.a.createElement(s.b,{exact:!0,path:"/preview"},l.a.createElement(B,{bookData:i})),l.a.createElement(s.a,{exact:!0,from:"/",to:r?"/edit":"/upload"}))})),P=l.a.memo((function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(null),u=Object(i.a)(r,2),d=u[0],b=u[1],E=Object(n.useState)(null),f=Object(i.a)(E,2),v=f[0],p=f[1];return Object(n.useEffect)((function(){var e=(console.warn("Not implemented getBookContentFromServer. Returning null."),null);c(e)}),[]),l.a.createElement(n.Fragment,null,l.a.createElement(o.a,null,l.a.createElement(m,{pathName:d}),l.a.createElement("div",{className:"header-space"}),l.a.createElement(s.b,{path:"/"},l.a.createElement(I,{setPathName:b,bookContent:a,setBookContent:c,bookData:v,setBookData:p}))))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement("div",{className:"container-fluid BookEditorContainer"},l.a.createElement(P,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[100,1,2]]]);
//# sourceMappingURL=main.2399b02e.chunk.js.map